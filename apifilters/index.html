<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://dbarzin.githubs.io/mercator/apifilters/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API Advanced (filters) - Mercator</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API Advanced (filters)";
        var mkdocs_page_input_path = "apifilters.md";
        var mkdocs_page_url = "/mercator/apifilters/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Mercator
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../cartography/">Views /Cartograpgy</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../application/">Application</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../maturity/">Maturity Levels</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../bpmn/">BPMN 2.0 Module</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../reports/">Reports</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../exploration/">Exploration Feature</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../usecases/">Use cases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../model/">Data model</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../import/">Data Import/Export Interface</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../api/">API</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">API Advanced (filters)</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#filtering-sorting-and-including-relations">Filtering, Sorting and Including Relations</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#filterable-fields">Filterable Fields</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#filter-syntax">Filter Syntax</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#available-filtering-operators">Available Filtering Operators</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#exact-and-text-filters">Exact and Text Filters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#numeric-comparisons">Numeric Comparisons</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#advanced-operators">Advanced Operators</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#global-search-and-relation-filters">Global Search and Relation Filters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#date-filters">Date Filters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#soft-deletes">Soft Deletes</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#sorting-results">Sorting Results</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#including-relations-eager-loading">Including Relations (Eager Loading)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#complete-cases">Complete cases</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#simple-filters">Simple Filters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#combined-filters">Combined Filters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#advanced-filters">Advanced Filters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#with-sorting-and-relations">With Sorting and Relations</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#authentication-with-email-password">Authentication with email / password</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#authentication-with-api-token">Authentication with API Token</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#filters-examples">Filters Examples</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#php">PHP</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#authentication_1">Authentication</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#list-of-activities-with-filters">List of Activities with Filters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#retrieve-an-activity-with-relations">Retrieve an Activity with Relations</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#python">Python</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#bash">bash</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#powershell">Powershell</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#step-1-authentication-and-obtaining-access-token">Step 1 â€” Authentication and Obtaining Access Token</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-2-usage-with-filters-and-sort">Step 2 â€” Usage with Filters and Sort</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#feature-summary">Feature Summary</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../admin/">Mercator administration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../config/">Mercator Configuration Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../references/">References</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Mercator</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">API Advanced (filters)</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/dbarzin/mercator/edit/master/docs/apifilters.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api-advanced-filters">API Advanced (filters)</h1>
<p>ðŸ‡«ðŸ‡· <a href="/mercator/fr/apifilters">Lire en franÃ§ais</a></p>
<p>This part is an addition of the API chapter <a href="../api/">API</a>.</p>
<h3 id="filtering-sorting-and-including-relations">Filtering, Sorting and Including Relations</h3>
<p>List endpoints (<code>GET /api/objects</code>) support an advanced system of filters, sorting and relation inclusion via
query parameters.</p>
<h4 id="filterable-fields">Filterable Fields</h4>
<p>All fields declared in the model (<code>$fillable</code>) are automatically filterable. Filters on unauthorized
fields are simply ignored.</p>
<h4 id="filter-syntax">Filter Syntax</h4>
<p>Each filter is presented in the form:</p>
<pre><code class="language-text">filter[&lt;field&gt;]=&lt;value&gt;                     # Exact filter
filter[&lt;field&gt;_&lt;operator&gt;]=&lt;value&gt;          # Filter with operator
</code></pre>
<h4 id="available-filtering-operators">Available Filtering Operators</h4>
<h5 id="exact-and-text-filters">Exact and Text Filters</h5>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Syntax</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>(none)</td>
<td><code>filter[name]=Backup</code></td>
<td>Exact equality</td>
<td><code>name = 'Backup'</code></td>
</tr>
<tr>
<td>(partial)</td>
<td><code>filter[name]=backup</code></td>
<td>Partial search (LIKE) *</td>
<td><code>name LIKE '%backup%'</code></td>
</tr>
</tbody>
</table>
<p><em>* Automatic partial search applies to fields containing: <code>name</code>, <code>description</code>, <code>email</code></em></p>
<h5 id="numeric-comparisons">Numeric Comparisons</h5>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Syntax</th>
<th>Description</th>
<th>SQL Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_lt</code></td>
<td><code>filter[recovery_time_objective_lt]=4</code></td>
<td>Less than</td>
<td><code>recovery_time_objective &lt; 4</code></td>
</tr>
<tr>
<td><code>_lte</code></td>
<td><code>filter[recovery_time_objective_lte]=4</code></td>
<td>Less than or equal to</td>
<td><code>recovery_time_objective &lt;= 4</code></td>
</tr>
<tr>
<td><code>_gt</code></td>
<td><code>filter[recovery_time_objective_gt]=8</code></td>
<td>Greater than</td>
<td><code>recovery_time_objective &gt; 8</code></td>
</tr>
<tr>
<td><code>_gte</code></td>
<td><code>filter[recovery_time_objective_gte]=8</code></td>
<td>Greater than or equal to</td>
<td><code>recovery_time_objective &gt;= 8</code></td>
</tr>
</tbody>
</table>
<h5 id="advanced-operators">Advanced Operators</h5>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Syntax</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_in</code></td>
<td><code>filter[id_in]=1,2,3</code></td>
<td>Value in a list</td>
<td><code>id IN (1, 2, 3)</code></td>
</tr>
<tr>
<td><code>_between</code></td>
<td><code>filter[recovery_time_objective_between]=4,24</code></td>
<td>Between two values</td>
<td><code>recovery_time_objective BETWEEN 4 AND 24</code></td>
</tr>
<tr>
<td><code>_null</code></td>
<td><code>filter[deleted_at_null]=true</code></td>
<td>NULL value</td>
<td><code>deleted_at IS NULL</code></td>
</tr>
<tr>
<td><code>_null</code></td>
<td><code>filter[description_null]=false</code></td>
<td>NOT NULL value</td>
<td><code>description IS NOT NULL</code></td>
</tr>
<tr>
<td><code>_not</code></td>
<td><code>filter[type_not]=opensource</code></td>
<td>Negation (different)</td>
<td><code>type != 'opensource'</code></td>
</tr>
</tbody>
</table>
<h5 id="global-search-and-relation-filters">Global Search and Relation Filters</h5>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Syntax</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>search</code></td>
<td><code>filter[search]=backup</code></td>
<td>OR search on all text fields (name, description, email)</td>
<td><code>name LIKE '%backup%' OR description LIKE '%backup%'</code></td>
</tr>
<tr>
<td>(relation)</td>
<td><code>filter[actors.email]=john</code></td>
<td>LIKE search on relation fields</td>
<td><code>actors.email LIKE '%john%'</code></td>
</tr>
<tr>
<td>(relation)</td>
<td><code>filter[contacts.name]=alice</code></td>
<td>LIKE search on name in a relation</td>
<td><code>contacts.name LIKE '%alice%'</code></td>
</tr>
</tbody>
</table>
<h5 id="date-filters">Date Filters</h5>
<p>For fields containing <code>date</code> or <code>at</code> in their name:</p>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Syntax</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_after</code></td>
<td><code>filter[created_at_after]=2024-01-01</code></td>
<td>After this date</td>
<td><code>created_at &gt;= '2024-01-01'</code></td>
</tr>
<tr>
<td><code>_before</code></td>
<td><code>filter[updated_at_before]=2024-12-31</code></td>
<td>Before this date</td>
<td><code>updated_at &lt;= '2024-12-31'</code></td>
</tr>
</tbody>
</table>
<h5 id="soft-deletes">Soft Deletes</h5>
<table>
<thead>
<tr>
<th>Syntax</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filter[trashed]=with</code></td>
<td>Include deleted items</td>
</tr>
<tr>
<td><code>filter[trashed]=only</code></td>
<td>Only deleted items</td>
</tr>
</tbody>
</table>
<h4 id="sorting-results">Sorting Results</h4>
<p>Sorting is done with the <code>sort</code> parameter:</p>
<pre><code class="language-text">sort=&lt;field&gt;        # Ascending sort
sort=-&lt;field&gt;       # Descending sort
</code></pre>
<p>Examples:</p>
<ul>
<li><code>sort=name</code> : Sort by name ascending</li>
<li><code>sort=-created_at</code> : Sort by creation date descending</li>
<li><code>sort=recovery_time_objective</code> : Sort by RTO ascending</li>
</ul>
<h4 id="including-relations-eager-loading">Including Relations (Eager Loading)</h4>
<p>Relations between objects can be loaded with the <code>include</code> parameter:</p>
<pre><code class="language-text">include=&lt;relation1&gt;,&lt;relation2&gt;
</code></pre>
<p>Available relations are automatically detected from the model. For activities, for example:</p>
<ul>
<li><code>processes</code> : Related processes</li>
<li><code>operations</code> : Related operations</li>
<li><code>applications</code> : Related applications</li>
<li><code>impacts</code> : Related impacts</li>
</ul>
<p>Example: <code>include=processes,operations</code></p>
<h4 id="complete-cases">Complete cases</h4>
<h5 id="simple-filters">Simple Filters</h5>
<pre><code class="language-http"># Activities with name containing &quot;backup&quot;
GET /api/activities?filter[name]=backup

# Activities with RTO less than or equal to 4 hours
GET /api/activities?filter[recovery_time_objective_lte]=4

# Activities with ID greater than or equal to 100
GET /api/activities?filter[id_gte]=100

# Applications with type different from &quot;opensource&quot;
GET /api/applications?filter[type_not]=opensource

# Global search on all text fields
GET /api/applications?filter[search]=backup

# Search on linked actor's email
GET /api/activities?filter[actors.email]=john@example.com
</code></pre>
<h5 id="combined-filters">Combined Filters</h5>
<pre><code class="language-http"># Activities with name containing &quot;GDPR&quot; and RTO &gt;= 8
GET /api/activities?filter[name]=GDPR&amp;filter[recovery_time_objective_gte]=8

# Servers created after January 1, 2024 with name containing &quot;prod&quot;
GET /api/logical-servers?filter[created_at_after]=2024-01-01&amp;filter[name]=prod

# Applications with type different from &quot;opensource&quot; sorted by name
GET /api/applications?filter[type_not]=opensource&amp;sort=name

# Global search &quot;backup&quot; on all activities with RTO &lt;= 8
GET /api/activities?filter[search]=backup&amp;filter[recovery_time_objective_lte]=8

# Activities linked to an actor whose email contains &quot;admin&quot;
GET /api/activities?filter[actors.email]=admin&amp;include=actors
</code></pre>
<h5 id="advanced-filters">Advanced Filters</h5>
<pre><code class="language-http"># Activities with ID in the list 1, 2, 3, 5
GET /api/activities?filter[id_in]=1,2,3,5

# Activities with RTO between 4 and 24 hours
GET /api/activities?filter[recovery_time_objective_between]=4,24

# Activities without description
GET /api/activities?filter[description_null]=true

# Activities with a description
GET /api/activities?filter[description_null]=false

# Include soft-deleted items
GET /api/activities?filter[trashed]=with

# Only soft-deleted items
GET /api/activities?filter[trashed]=only
</code></pre>
<h5 id="with-sorting-and-relations">With Sorting and Relations</h5>
<pre><code class="language-http"># Activities with RTO &gt;= 8, sorted by creation date descending
GET /api/activities?filter[recovery_time_objective_gte]=8&amp;sort=-created_at

# Activities with name &quot;GDPR&quot;, including related processes and operations
GET /api/activities?filter[name]=GDPR&amp;include=processes,operations

# Complete example: filters + sort + include
GET /api/activities?filter[recovery_time_objective_gte]=8&amp;filter[name]=GDPR&amp;sort=-created_at&amp;include=processes,operations
</code></pre>
<h3 id="authentication">Authentication</h3>
<h4 id="authentication-with-email-password">Authentication with email / password</h4>
<p>To use the API, it is necessary to obtain an authentication token.</p>
<p>Endpoint : <code>POST /api/login</code></p>
<p>Parameters :</p>
<ul>
<li><strong>login</strong> : User's email address</li>
<li><strong>password</strong> : User's password</li>
</ul>
<p>Example with CURL:</p>
<pre><code class="language-bash">curl -X POST http://127.0.0.1:8000/api/login \
  -d &quot;login=admin@admin.com&quot; \
  -d &quot;password=password&quot;
</code></pre>
<p>The API returns a token in JSON format:</p>
<pre><code class="language-json">{
  &quot;access_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9...&quot;
}
</code></pre>
<p>This token must be included in the <code>Authorization</code> header for all subsequent requests:</p>
<pre><code class="language-bash">curl -X GET http://127.0.0.1:8000/api/activities \
  -H &quot;Authorization: Bearer YOUR_ACCESS_TOKEN&quot;
</code></pre>
<h4 id="authentication-with-api-token">Authentication with API Token</h4>
<p>It's possible to create an API token directly from the interface.</p>
<p>For this:</p>
<ul>
<li>Click on "Profile" in the top menu</li>
<li>Go to the "API Token" section</li>
<li>Click on "Create a new token"</li>
<li>Give a name to your token</li>
<li>Copy the generated token</li>
</ul>
<p>The token must be used in the <code>Authorization</code> header as a Bearer token.</p>
<h3 id="filters-examples">Filters Examples</h3>
<p>Here are practical examples of API usage in different programming languages.</p>
<h4 id="php">PHP</h4>
<h5 id="authentication_1">Authentication</h5>
<pre><code class="language-php">&lt;?php
    $curl = curl_init();

    curl_setopt_array($curl, array(
        CURLOPT_URL =&gt; &quot;http://127.0.0.1:8000/api/login&quot;,
        CURLOPT_RETURNTRANSFER =&gt; true,
        CURLOPT_MAXREDIRS =&gt; 10,
        CURLOPT_TIMEOUT =&gt; 30,
        CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
        CURLOPT_CUSTOMREQUEST =&gt; &quot;POST&quot;,
        CURLOPT_POSTFIELDS =&gt; &quot;login=admin@admin.com&amp;password=password&quot;,
        CURLOPT_HTTPHEADER =&gt; array(
            &quot;accept: application/json&quot;,
            &quot;cache-control: no-cache&quot;,
            &quot;content-type: application/x-www-form-urlencoded&quot;,
        ),
    ));

    $response = curl_exec($curl);
    $err = curl_error($curl);
    $info = curl_getinfo($curl);

    curl_close($curl);

    if ($err) {
        set_error_handler($err);
    } else {
        if ($info['http_code'] == 200) {
            $access_token = json_decode($response)-&gt;access_token;
        } else {
            set_error_handler(&quot;Login to api failed status 403&quot;);
            error_log($responseInfo['http_code']);
            error_log(&quot;No login api status 403&quot;);
        }
    }

    var_dump($response);
</code></pre>
<h5 id="list-of-activities-with-filters">List of Activities with Filters</h5>
<pre><code class="language-php">&lt;?php
    $curl = curl_init();

    // Build URL with filtering parameters
    $filters = http_build_query([
        'filter' =&gt; [
            'recovery_time_objective_gte' =&gt; 8,
            'name' =&gt; 'GDPR'
        ],
        'sort' =&gt; '-created_at',
        'include' =&gt; 'processes,operations'
    ]);

    curl_setopt_array($curl, array(
        CURLOPT_URL =&gt; &quot;http://127.0.0.1:8000/api/activities?&quot; . $filters,
        CURLOPT_RETURNTRANSFER =&gt; true,
        CURLOPT_MAXREDIRS =&gt; 10,
        CURLOPT_TIMEOUT =&gt; 30,
        CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
        CURLOPT_CUSTOMREQUEST =&gt; &quot;GET&quot;,
        CURLOPT_HTTPHEADER =&gt; array(
            &quot;accept: application/json&quot;,
            &quot;Authorization: Bearer &quot; . $access_token,
            &quot;cache-control: no-cache&quot;,
            &quot;content-type: application/json&quot;,
        ),
    ));

    $response = curl_exec($curl);
    $err = curl_error($curl);
    curl_close($curl);

    var_dump($response);
</code></pre>
<h5 id="retrieve-an-activity-with-relations">Retrieve an Activity with Relations</h5>
<pre><code class="language-php">&lt;?php
    $curl = curl_init();

    curl_setopt_array($curl, array(
        CURLOPT_URL =&gt; &quot;http://127.0.0.1:8000/api/activities/1?include=processes,operations&quot;,
        CURLOPT_RETURNTRANSFER =&gt; true,
        CURLOPT_MAXREDIRS =&gt; 10,
        CURLOPT_TIMEOUT =&gt; 30,
        CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
        CURLOPT_CUSTOMREQUEST =&gt; &quot;GET&quot;,
        CURLOPT_HTTPHEADER =&gt; array(
            &quot;accept: application/json&quot;,
            &quot;Authorization: Bearer &quot; . $access_token,
            &quot;cache-control: no-cache&quot;,
            &quot;content-type: application/json&quot;,
        ),
    ));

    $response = curl_exec($curl);
    $err = curl_error($curl);
    curl_close($curl);

    var_dump($response);
</code></pre>
<h4 id="python">Python</h4>
<p>Here is an example of API usage in Python with advanced filters</p>
<pre><code class="language-python">#!/usr/bin/python3

import requests

vheaders = {}
vheaders['accept'] = 'application/json'
vheaders['content-type'] = 'application/x-www-form-urlencoded'
vheaders['cache-control'] = 'no-cache'

print(&quot;Login&quot;)
response = requests.post(&quot;http://127.0.0.1:8000/api/login&quot;,
    headers=vheaders,
    data={'login':'admin@admin.com', 'password':'password'})
print(response.status_code)

vheaders['Authorization'] = &quot;Bearer &quot; + response.json()['access_token']

# List with filters and sort
print(&quot;Get workstations with filters&quot;)
params = {
    'filter[name]': 'laptop',
    'sort': '-created_at'
}
response = requests.get(&quot;http://127.0.0.1:8000/api/workstations&quot;, 
    headers=vheaders, 
    params=params)
print(response.json())
print(response.status_code)

# Retrieval with relations
print(&quot;Get activity with relations&quot;)
params = {
    'include': 'processes,operations'
}
response = requests.get(&quot;http://127.0.0.1:8000/api/activities/1&quot;,
    headers=vheaders,
    params=params)
print(response.json())
</code></pre>
<h4 id="bash">bash</h4>
<p>Here is an example of API usage from the command line with <a href="https://curl.se/docs/manpage.html">CURL</a>
and <a href="https://stedolan.github.io/jq/">JQ</a></p>
<pre><code class="language-bash">#!/usr/bin/bash

API_URL=http://127.0.0.1:8000/api
OBJECT=applications
OBJECT_ID=45

# Valid credentials
data='{&quot;login&quot;:&quot;admin@admin.com&quot;,&quot;password&quot;:&quot;password&quot;}'

# Get a token after login
TOKEN=$(curl -s -d ${data} -H &quot;Content-Type: application/json&quot; ${API_URL}/login | jq -r .access_token)

# List with filters
echo &quot;List of applications with filters...&quot;
curl -s -X GET &quot;${API_URL}/${OBJECT}?filter[name]=CRM&amp;sort=-created_at&quot; \
  -H &quot;Authorization: Bearer ${TOKEN}&quot; \
  -H &quot;Accept: application/json&quot; | jq .

# Retrieval with relations
echo &quot;Retrieving an object with relations...&quot;
RESPONSE=$(curl -s -X GET &quot;${API_URL}/${OBJECT}/${OBJECT_ID}?include=databases,processes&quot; \
  -H &quot;Authorization: Bearer ${TOKEN}&quot; \
  -H &quot;Accept: application/json&quot;)

echo &quot;Retrieved object: ${RESPONSE}&quot;

# Update
RESPONSE=$(echo &quot;$RESPONSE&quot; | jq -c '.')
RESPONSE=$(echo &quot;$RESPONSE&quot; | jq -r '.activities=[1]')

echo &quot;Modified object: ${RESPONSE}&quot;

curl -s -X PUT &quot;${API_URL}/${OBJECT}/${OBJECT_ID}&quot; \
  -H &quot;Authorization: Bearer ${TOKEN}&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -H &quot;cache-control: no-cache&quot; \
  -d &quot;$RESPONSE&quot;

# Verification
UPDATED_OBJECT=$(curl -s -X GET &quot;${API_URL}/${OBJECT}/${OBJECT_ID}&quot; \
  -H &quot;Authorization: Bearer ${TOKEN}&quot; \
  -H &quot;Accept: application/json&quot;)

echo &quot;Updated object: ${UPDATED_OBJECT}&quot;
</code></pre>
<h4 id="powershell">Powershell</h4>
<p>The PowerShell script below shows how to authenticate with the API and use advanced filters.</p>
<h5 id="step-1-authentication-and-obtaining-access-token">Step 1 â€” Authentication and Obtaining Access Token</h5>
<pre><code class="language-powershell"># Define authentication URL and credentials
$loginUri = &quot;http://127.0.0.1:8000/api/login&quot;
$loginBody = @{
    login = &quot;admin@admin.com&quot;
    password = &quot;password&quot;
}

# Send authentication request
try {
    $loginResponse = Invoke-RestMethod -Uri $loginUri -Method Post -Body $loginBody -ContentType &quot;application/x-www-form-urlencoded&quot;
    $token = $loginResponse.access_token
    Write-Host &quot;Access token retrieved successfully.&quot;
} catch {
    Write-Error &quot;Authentication failed: $_&quot;
    return
}
</code></pre>
<h5 id="step-2-usage-with-filters-and-sort">Step 2 â€” Usage with Filters and Sort</h5>
<pre><code class="language-powershell"># Define headers
$headers = @{
    'Authorization' = &quot;Bearer $token&quot;
    'Accept'        = 'application/json'
}

# List with filters
$endPoint = &quot;logical-servers&quot;
$filters = &quot;filter[operating_system]=Linux&amp;sort=-created_at&quot;
$apiUri = &quot;http://127.0.0.1:8000/api/$endPoint?$filters&quot;

try {
    $servers = Invoke-RestMethod -Uri $apiUri -Method Get -Headers $headers
    $servers | Format-Table id, name, operating_system, description
} catch {
    Write-Error &quot;Request failed: $_&quot;
}

# Retrieval with relations
$activityId = 1
$apiUri = &quot;http://127.0.0.1:8000/api/activities/$activityId?include=processes,operations&quot;

try {
    $activity = Invoke-RestMethod -Uri $apiUri -Method Get -Headers $headers
    $activity | ConvertTo-Json -Depth 10
} catch {
    Write-Error &quot;Request failed: $_&quot;
}
</code></pre>
<h3 id="feature-summary">Feature Summary</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Syntax</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exact filter</td>
<td><code>filter[field]=value</code></td>
<td><code>filter[name]=Backup</code></td>
</tr>
<tr>
<td>Comparison</td>
<td><code>filter[field_operator]=value</code></td>
<td><code>filter[recovery_time_objective_gte]=8</code></td>
</tr>
<tr>
<td>Negation</td>
<td><code>filter[field_not]=value</code></td>
<td><code>filter[type_not]=opensource</code></td>
</tr>
<tr>
<td>List of values</td>
<td><code>filter[field_in]=v1,v2,v3</code></td>
<td><code>filter[id_in]=1,2,3</code></td>
</tr>
<tr>
<td>Range</td>
<td><code>filter[field_between]=min,max</code></td>
<td><code>filter[age_between]=18,65</code></td>
</tr>
<tr>
<td>NULL</td>
<td><code>filter[field_null]=true/false</code></td>
<td><code>filter[deleted_at_null]=true</code></td>
</tr>
<tr>
<td>Dates</td>
<td><code>filter[field_after/before]=date</code></td>
<td><code>filter[created_at_after]=2024-01-01</code></td>
</tr>
<tr>
<td>Global search</td>
<td><code>filter[search]=term</code></td>
<td><code>filter[search]=backup</code></td>
</tr>
<tr>
<td>Relation</td>
<td><code>filter[relation.field]=value</code></td>
<td><code>filter[actors.email]=john</code></td>
</tr>
<tr>
<td>Sort</td>
<td><code>sort=field</code> or <code>sort=-field</code></td>
<td><code>sort=-created_at</code></td>
</tr>
<tr>
<td>Relations</td>
<td><code>include=relation1,relation2</code></td>
<td><code>include=processes,operations</code></td>
</tr>
<tr>
<td>Soft deletes</td>
<td><code>filter[trashed]=with/only</code></td>
<td><code>filter[trashed]=with</code></td>
</tr>
</tbody>
</table>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../api/" class="btn btn-neutral float-left" title="API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../admin/" class="btn btn-neutral float-right" title="Mercator administration">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright <a href="https://www.gnu.org/licenses/licenses.en.html">GPL</a>.</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/dbarzin/mercator" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../api/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../admin/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
